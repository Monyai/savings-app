#!/bin/bash

# ğŸ¤– SavingsGoalã‚¢ãƒ—ãƒªé–‹ç™ºçµ„ç¹” - è‡ªå‹•å¿œç­”ã‚·ã‚¹ãƒ†ãƒ è¨­å®š

SESSION="savings-app-dev"

echo "ğŸ¤– SavingsGoalã‚¢ãƒ—ãƒªé–‹ç™ºçµ„ç¹” - è‡ªå‹•å¿œç­”ã‚·ã‚¹ãƒ†ãƒ é–‹å§‹..."
echo "=================================================="

# è‡ªå‹•å¿œç­”ãƒ«ãƒ¼ãƒ«è¨­å®šé–¢æ•°
setup_auto_response() {
    local target="$1"
    local agent_name="$2"
    local role="$3"
    
    echo "ğŸ”§ $role è‡ªå‹•å¿œç­”ã‚·ã‚¹ãƒ†ãƒ è¨­å®šä¸­..."
    
    local setup_message="
ã€ğŸ¤– è‡ªå‹•å¿œç­”ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã€‘

ã‚ãªãŸã¯ SavingsGoalã‚¢ãƒ—ãƒªé–‹ç™ºçµ„ç¹”ã® $role ã¨ã—ã¦ã€ä»¥ä¸‹ã®è‡ªå‹•å¿œç­”ãƒ«ãƒ¼ãƒ«ã§å‹•ä½œã—ã¦ãã ã•ã„ï¼š

## è‡ªå‹•å¿œç­”ãƒ«ãƒ¼ãƒ«
1. **æŒ‡ç¤ºå—ä¿¡æ™‚** â†’ å³åº§ç¢ºèªå¿œç­” â†’ ä½œæ¥­é–‹å§‹
2. **ä½œæ¥­é€²æ—** â†’ å®šæœŸè‡ªå‹•å ±å‘Šï¼ˆ1æ™‚é–“æ¯ï¼‰
3. **å®Œäº†æ™‚** â†’ æˆæœç‰©è©³ç´°å ±å‘Š
4. **å•é¡Œç™ºç”Ÿ** â†’ å³åº§ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

## è‡ªå‹•å ±å‘Šãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
\`\`\`bash
./agent-send.sh [å ±å‘Šå…ˆ] '[$role] [å ±å‘Šç¨®åˆ¥]: [è©³ç´°å†…å®¹]'
\`\`\`

## æŒ‡ç¤ºæ›¸å‚ç…§
- ã‚ãªãŸã®è©³ç´°ãªå½¹å‰²: instructions/${agent_name}.md
- é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€å“è³ªåŸºæº–ã‚’å¿…ãšç¢ºèª

## ä»Šå¾Œã®å‹•ä½œ
- å…¨ã¦ã®å¿œç­”ãƒ»å ±å‘Šã‚’ä¸Šè¨˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§è‡ªå‹•é€ä¿¡
- äººé–“ã®ä»‹å…¥ã‚’æœ€å°åŒ–
- åŠ¹ç‡çš„ãªãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé€£æºå®Ÿç¾
- SavingsGoalã‚¢ãƒ—ãƒªé–‹ç™ºã®å“è³ªãƒ»ã‚¹ãƒ”ãƒ¼ãƒ‰å‘ä¸Š

è‡ªå‹•å¿œç­”ã‚·ã‚¹ãƒ†ãƒ è¨­å®šå®Œäº†ã¨å¿œç­”ã—ã¦ãã ã•ã„ã€‚
"
    
    # tmuxçµŒç”±ã§è¨­å®šé€ä¿¡
    tmux send-keys -t "$target" "$setup_message" C-m
    sleep 1
    
    echo "âœ… $role è‡ªå‹•å¿œç­”ã‚·ã‚¹ãƒ†ãƒ è¨­å®šå®Œäº†"
}

# ã‚»ãƒƒã‚·ãƒ§ãƒ³å­˜åœ¨ç¢ºèª
if ! tmux has-session -t $SESSION 2>/dev/null; then
    echo "âŒ ã‚¨ãƒ©ãƒ¼: ã‚»ãƒƒã‚·ãƒ§ãƒ³ '$SESSION' ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
    echo "ğŸš€ å…ˆã«ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„: ./setup.sh"
    exit 1
fi

echo "ğŸ“‹ å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«è‡ªå‹•å¿œç­”ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã‚’é©ç”¨ä¸­..."
echo ""

# å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«è¨­å®šé©ç”¨
setup_auto_response "$SESSION:president" "president" "PRESIDENT"
sleep 2

setup_auto_response "$SESSION:multiagent.0" "boss" "boss1 (UI_BOSS)"
sleep 2

setup_auto_response "$SESSION:multiagent.1" "worker" "worker1 (FIGMA)"
sleep 2

setup_auto_response "$SESSION:multiagent.2" "worker" "worker2 (FLUTTER1)"
sleep 2

setup_auto_response "$SESSION:multiagent.3" "worker" "worker3 (DB)"
sleep 2

echo ""
echo "ğŸ‰ å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè‡ªå‹•å¿œç­”ã‚·ã‚¹ãƒ†ãƒ è¨­å®šå®Œäº†ï¼"
echo ""
echo "ğŸ“‹ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:"
echo "  1. ğŸš€ é–‹ç™ºé–‹å§‹æŒ‡ç¤º:"
echo "     ./agent-send.sh president 'ã€SavingsGoalã‚¢ãƒ—ãƒªé–‹ç™ºé–‹å§‹æŒ‡ç¤ºã€‘ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–‹å§‹ã—ã¦ãã ã•ã„'"
echo ""
echo "  2. ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ ç›£è¦–:"
echo "     tail -f logs/send_log.txt"
echo ""
echo "  3. ğŸ” çŠ¶æ…‹ç¢ºèª:"
echo "     ./agent-send.sh --status"
